# =============================================================================
# CloudDocs API Service - Environment Configuration
# =============================================================================
# This file contains default values and serves as documentation.
# To override values locally, create .env.local (git-ignored):
#   cp .env.example .env.local
# Then edit only the variables you need to change in .env.local
#
# Loading priority (later overrides earlier):
#   .env.example → .env → .env.local → .env.{NODE_ENV} → .env.{NODE_ENV}.local
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
PORT=4000
NODE_ENV=development

# -----------------------------------------------------------------------------
# MongoDB Configuration
# -----------------------------------------------------------------------------
# Local development with Docker:
MONGO_URI=mongodb://localhost:27017/clouddocs

# With authentication (production):
# MONGO_URI=mongodb://user:password@host:27017/clouddocs?authSource=admin

# -----------------------------------------------------------------------------
# Elasticsearch Configuration (Optional)
# -----------------------------------------------------------------------------
# Enable/disable Elasticsearch (search works without it, just limited)
ELASTICSEARCH_ENABLED=false

# Elasticsearch connection
ELASTICSEARCH_NODE=http://localhost:9200

# With authentication (production):
# ELASTICSEARCH_USERNAME=elastic
# ELASTICSEARCH_PASSWORD=changeme

# -----------------------------------------------------------------------------
# Auto-Deletion Job Configuration
# -----------------------------------------------------------------------------
# Cron expression for auto-deletion job (default: daily at 2:00 AM)
# Format: '0 2 * * *' = every day at 2:00 AM
# For testing: '*/5 * * * *' = every 5 minutes
AUTO_DELETE_CRON=0 2 * * *

# -----------------------------------------------------------------------------
# Authentication & Security
# -----------------------------------------------------------------------------
# JWT secret - CHANGE IN PRODUCTION!
JWT_SECRET=change_me_in_production_use_strong_random_string

# JWT token expiration
JWT_EXPIRES_IN=1d

# Password hashing rounds (higher = more secure but slower)
BCRYPT_SALT_ROUNDS=10

# CSRF secret - CHANGE IN PRODUCTION!
CSRF_SECRET=change_me_csrf_secret_in_production

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Allowed origins (comma-separated for multiple)
# Development: localhost ports are auto-allowed
# Production: set explicit origins
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# Allow requests without Origin header (for server-to-server, mobile apps)
ALLOW_NO_ORIGIN=false

# -----------------------------------------------------------------------------
# File Upload Configuration
# -----------------------------------------------------------------------------
# Maximum upload size in bytes (5MB default)
MAX_UPLOAD_SIZE=5242880

# Allowed MIME types (comma-separated)
ALLOWED_MIME_TYPES=application/pdf,image/png,image/jpeg,image/gif,text/plain,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document

# -----------------------------------------------------------------------------
# Email Configuration (Optional - for confirmation emails)
# -----------------------------------------------------------------------------
# Using Mailtrap for development:
EMAIL_HOST=smtp.mailtrap.io
EMAIL_PORT=2525
EMAIL_USER=your_mailtrap_user
EMAIL_PASS=your_mailtrap_pass
EMAIL_ALLOW_INSECURE_TLS=true
EMAIL_SECURE=false

# Enable/disable confirmation emails
SEND_CONFIRMATION_EMAIL=false

# URLs for email links
CONFIRMATION_URL_BASE=http://localhost:4000
CONFIRMATION_FRONTEND_URL=http://localhost:5173

# -----------------------------------------------------------------------------
# AI & Vector Search Configuration
# -----------------------------------------------------------------------------
# MongoDB Atlas connection for vector search (embeddings)
# This is separate from the local MongoDB used for main data
MONGO_ATLAS_URI=mongodb+srv://user:password@cluster.mongodb.net/cloud_docs_ia

# MongoDB Atlas Search index name for vector search (set this to the
# Search Index you created in Atlas). If omitted, the application uses
# the default index name `default`.
# Example: MONGO_ATLAS_VECTOR_INDEX=vector_index
MONGO_ATLAS_VECTOR_INDEX=default

# (Optional) Document the expected vector dimensionality for the active
# provider. This is informational only — the application reads vector
# dimensionality from the embedding provider at runtime. Keep this in
# sync with your provider (e.g. Ollama=768, OpenAI=1536).
# MONGO_ATLAS_VECTOR_NUM_DIMENSIONS=768

# -----------------------------------------------------------------------------
# AI Provider Selection
# -----------------------------------------------------------------------------
# Choose which AI provider to use: 'openai' | 'ollama' | 'mock'
# - openai: Uses OpenAI API (requires OPENAI_API_KEY, costs money)
# - ollama: Uses local Ollama models (free, no API key needed, requires Ollama installed)
# - mock: Uses mock responses (for testing, instant, deterministic)
AI_PROVIDER=openai

# -----------------------------------------------------------------------------
# OpenAI Configuration (when AI_PROVIDER=openai)
# -----------------------------------------------------------------------------
# OpenAI API key for embeddings and chat completions
# Get your API key from: https://platform.openai.com/api-keys
# Model used: gpt-4o-mini (chat) + text-embedding-3-small (embeddings, 1536 dims)
OPENAI_API_KEY=sk-your-openai-api-key-here

# -----------------------------------------------------------------------------
# Ollama Configuration (when AI_PROVIDER=ollama)
# -----------------------------------------------------------------------------
# Ollama server URL (default: http://localhost:11434)
# Install: winget install Ollama.Ollama
# Download models: ollama pull llama3.2:3b && ollama pull nomic-embed-text
OLLAMA_BASE_URL=http://localhost:11434

# Ollama chat model for text generation
# Options: llama3.2:3b (recommended), llama3.2:1b, llama3.1:8b, etc.
OLLAMA_CHAT_MODEL=llama3.2:3b

# Ollama embedding model for vector embeddings (768 dims)
# Options: nomic-embed-text (recommended), mxbai-embed-large, etc.
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

# Ollama retry attempts for transient network errors (default: 3 in dev/prod, 1 in test)
# Set to 1 for tests to avoid slow retries. The app automatically uses 1 in test env.
# OLLAMA_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# OCR (Optical Character Recognition) - optional
# -----------------------------------------------------------------------------
# Enable OCR to extract text from images and scanned PDFs (true/false)
OCR_ENABLED=true

# Languages for OCR (Tesseract-style, e.g. 'spa+eng')
OCR_LANGUAGES=spa+eng

# Optional: explicit path to tesseract executable if not on PATH (Windows example)
# TESSERACT_PATH=C:\\Program Files\\Tesseract-OCR\\tesseract.exe
